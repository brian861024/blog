---
title: 使用者、角色與權限(3)
published: 2026-02-12
tags: [Coding, Notes, RBAC]
category: 程式雜記
description: User的編碼大坑。
draft: false
---

# 千萬不要拿外部的資料當作唯一主鍵

在設計資料表時，**千萬不要拿外部的資料當作唯一主鍵**！  
這些看似唯一的資料，實務上可能帶來很多麻煩。  

### 常見不建議作為主鍵的資料

- E-mail 
- 手機號碼  
- 身分證號  

雖然這些資料通常是唯一值，但用來當主鍵會讓系統遇到特殊需求時非常難處理。

<hr>

## 為什麼不能當主鍵？

以 **身分證號** 為例：

1. **外國人沒有身分證號**  
   - 系統需要特別處理 → 破壞邏輯一致性  

2. **身分證號更新或替換**  
   - 例如改號、補發 → 主鍵被改掉，資料關聯可能錯亂  

3. **外國人取得身分證**  
   - 需建立新帳號還是覆蓋舊資料？  
   - 這會產生額外的邏輯判斷和例外處理  

> 這些問題會讓程式碼和需求膨脹，導致維護困難。

<hr>

## 建議做法

- **使用系統自建的唯一主鍵**  
  - 例如自增 ID 或 UUID  
- 外部資料作為 **非主鍵欄位**  
  - 用來查詢或驗證，而不是系統識別  
- 保持資料表彈性，避免因外部資料變動而破壞資料完整性

<hr>

> 千萬不要拿外部資料當唯一 prime key！  
> 使用系統內部生成的識別碼，系統更穩定，也更容易維護。